<!DOCTYPE html>
<html lang="en">
<head>
  <title>Current meter</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="/static/css/bootstrap.min.css">

  <script src="/static/js/jquery.min.js"></script>
  <script src="/static/js/bootstrap.min.js"></script>
  <link rel="stylesheet" type="text/css" href="/static/css/cmeter.css">


 <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>-->
  <script src="/static/js/chart.js@2.8.0"></script> 

<script src="/static/js/hammerjs@2.0.8"></script>
<script src="/static/js/chartjs-plugin-zoom@0.7.0"></script>


  <style>
	hr.deli {
    border: 0;
    background: white;
    height: 1px;
    background-image: -webkit-linear-gradient(left, rgba(0,0,0,0.75), rgba(0,0,0,0.0), rgba(0,0,0,0.75));
    background-image:    -moz-linear-gradient(left, rgba(0,0,0,0.75), rgba(0,0,0,0.0), rgba(0,0,0,0.75));
    background-image:     -ms-linear-gradient(left, rgba(0,0,0,0.75), rgba(0,0,0,0.0), rgba(0,0,0,0.75));
    background-image:      -o-linear-gradient(left, rgba(0,0,0,0.75), rgba(0,0,0,0.0), rgba(0,0,0,0.75));
	}
</style>
</head>

<body class="bg-dark text-white">
<nav class="navbar navbar-expand-sm bg-dark fixed-top navbar-dark shadow">
  <a class="navbar-brand"> 
    <img alt="Brand" class="img-responsive bg-secondary shadow rounded p-1" src="/static/img/logo.png">
  </a>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="collapsibleNavbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="/present">Текущие показания</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/history">История</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/journal">Журнал</a>
      </li>    
      <li class="nav-item">
        <a class="nav-link" href="/configure">Настройки</a>
      </li>   
    </ul>
  </div>  
</nav>


	{% block page %}
	{% endblock %}

   <a href="#x" class="overlay" id="alarm1"></a>
   <div class="popup text-red">
    <h1>Авария</h1>

    <table>
    <body>
      <tr>
        <td> <p>Время: </p> </td>
        <td> <p  class="text-right" id="alarm-time"></p> </td>
      </tr>
     <tr>
        <td> <p>Имя канала: </p> </td>
        <td> <p  class="text-right" id="alarm-src"></p> </td>
      </tr>
     <tr>
        <td> <p>Сообщение: </p> </td>
        <td> <p class="text-right" id="alarm-msg"></p> </td>
      </tr>

    </body>
    </table>

    <a class="close" title="Закрыть" href="#close"></a>
    </div>


<script>
    function load_alarm()
    {
        jQuery.ajax({
            url: "/api/get_alarm/",
            type: "GET",

            contentType: 'application/json; charset=utf-8',
            success: function(resultData) {
                console.log(resultData)
                if (resultData['isAlarm'] == true )
                {
                  var at=document.getElementById("alarm-time")
                  var as=document.getElementById("alarm-src")
                  var am=document.getElementById("alarm-msg")

                  at.innerHTML =resultData['time']
                  as.innerHTML =resultData['src']
                  am.innerHTML =resultData['msg']
                  window.location.hash="alarm1";
                }
            },
            error : function(jqXHR, textStatus, errorThrown) {
                alert( "Плохо" );
            },

            timeout: 120000,
        });     
    }

  // начать повторы с интервалом 2 сек
  var timerAlarm = setInterval(function() {
    load_alarm()
}, 5000);
</script>
<!-- Footer 

 <div class="d-flex">
  <div class="p-2 ">CPU: 27%</div>
  <div class="p-2">CPU: 27%</div>
  <div class="p-2"></div>
  
  <div class="ml-auto p-2 "></div>
  <div class="p-2">19:12:23</div>
  <div class="p-2">Тревога</div>
  <a href="#win1" class="button button-green">Открыть окно 1</a>


</div>
-->

</body>


</html>
